<section class="path">
  <div class="container">
    <div class="row">
      <div class="col-md-9">
      </div>
      <div class="col-md-3">
        <!-- Example single danger button -->
        <div class="btn-group" style="float: right">
          <button type="button" class="btn btn-warning dropdown-toggle px-3" data-toggle="dropdown">Phân loại</button>
          <div class="dropdown-menu">
            <a class="dropdown-item" href="#">Giá từ thấp đến cao</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="#">Giá từ cap đến thấp</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="#">Đặc sản yêu thích</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- end section path -->
<!-- section shop-menu -->
<section class="shop-menu">
  <div class="container">
    <div class="row">
      <div class="col-md-3 menu-left">
        <div class="type-of-fruits">
          <h2 class="titlte border-bottom">Khu vực</h2>
          <div class="list-item p-4">
            <ul>
              <% Region.all.each do |region| %>
                <li><a href="#"><%= region.name %></a></li>
              <% end %>
            </ul>
          </div>
        </div>
      </div>
      <div class="col-md-9 menu-right">
        <div class="title">
          <h2 class="border-bottom">Đặc sản Việt Nam</h2>
        </div>
        <div class="row all-products">
          <% @products.each do |pr|%>
            <div class="col-md-4 mb-30px">
                <div class="card text-center my-2 px-0 d-flex align-items-center h-100">
                  <%= link_to "product_detail/#{pr.id}", class: 'w-100 p-10px' do %>
                    <%= image_tag pr.photos.first.photo_url, class: 'w-100'%>
                  <% end %>
                  <div class="mt-auto">
                    <%= link_to pr.name, "product_detail/#{pr.id}", class: 'card-name font-size-20px font-weight-700 mt-20px'%>
                    <div class="price-css" style="text-decoration: line-through;"><span><%= number_with_delimiter(pr.price) %> vnd</span></div>
                    <span class="dis-price"><%= number_with_delimiter(discount(pr))%> vnd</span>
                    <div class="add-to-cart">
                      <button class='btn-minus' onclick="decrement(<%= pr.id %>)">-</button>
                      <input id='demoInput<%= pr.id %>' type='number' min='1' max='100' value='1' style= 'border: 1px solid #d9d9d9; text-align: center;'>
                      <button class='btn-plus' onclick="increment(<%= pr.id %>)">+</button>
                    </div>
                    <div class="view my-10px">
                      <%= link_to shopping_path, method: :post do %>
                        <button type="submit" class="btn btn-add2cart" onclick="addToCart(<%= pr.id %>)" data-bs-toggle="modal" data-bs-target="#addToCartModal">Thêm vào giỏ hàng</button>
                      <% end%>
                    </div>
                  </div>
                </div>
            </div>
          <% end %>
        </div>
        <div class="pagination mt-3">
          <%= render 'pagination', pagy: @pagy %>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- end section shop menu -->
<script>
  function increment(id) {
     document.getElementById('demoInput' + id).stepUp();
  }
  function decrement(id) {
     document.getElementById('demoInput' + id).stepDown();
  }
  function addToCart(id) {
    var quantity = $('#demoInput' + id).val()
    $.ajax({
      type: "POST",
      url: '/shopping',
      data: {
        item_id:  id,
        quantity: quantity
      },
      dataType: 'script'
    });
  }
</script>
<!-- Modal -->
<div class="modal fade" id="addToCartModal" tabindex="-1" aria-labelledby="addToCartModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addToCartModalLabel">Thông báo</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        Thêm vào giỏ hàng thành công
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>